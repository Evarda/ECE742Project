\documentclass{article}
\usepackage{amsmath}

\title{ECE 742 Final Project}
\author{
  Michelle King
  \and
  Suraj Suri
  }

\begin{document}
\maketitle
\section{Theory}
\subsection{PML}
Perfectly Matched Layer (PML) boundary conditions are absorbing boundary
conditions. PML BCs decay the wave within a boundary layer at the edge of the
simulation. The edge of the simulation BC can be implemented as PEC.
Well-implemented PML BCs completely decay the wave from the time it enters the
boundary layer to the time after it reflects and attempts to leave.

\subsection{Finite-Difference Derivation}
Let's start with equation:
\[\nabla \times \vec{H} = j \omega \epsilon \bar{\bar{s}} \vec{E}\]
Evaluate the cross product and write in matrix form:
\[
  $
  \begin{bmatrix}
    \frac{\partial H_{z}}{\partial y}-\frac{\partial H_{y}}{\partial z} \\
    \frac{\partial H_{x}}{\partial z}-\frac{\partial H_{z}}{\partial x} \\
    \frac{\partial H_{y}}{\partial x}-\frac{\partial H_{x}}{\partial y}
  \end{bmatrix}
  =
  j\omega\epsilon
  \begin{bmatrix}
    \frac{s_{y}s_{z}}{s_{x}} & 0                       & 0                       \\
    0                       & \frac{s_{x}s_{z}}{s_{y}} & 0                       \\
    0                       & 0                       & \frac{s_{x}s_{y}}{s_{z}} \\
  \end{bmatrix}
  \begin{bmatrix}
    E_{x} \\
    E_{y} \\
    E_{z}
  \end{bmatrix}
  $
\]
Where the values in the second rank tensor can be described by:
\[s_{x}=\kappa_{x}+\frac{\sigma_{x}}{j\omega\epsilon_{0}}\]
\[s_{y}=\kappa_{y}+\frac{\sigma_{y}}{j\omega\epsilon_{0}}\]
\[s_{z}=\kappa_{z}+\frac{\sigma_{z}}{j\omega\epsilon_{0}}\]
To make the calculation computationally more managable, we can define the following
relations:
\[D_{x}=\epsilon \frac{s_{z}}{s_{x}}E_{x}\]
\[D_{y}=\epsilon \frac{s_{x}}{s_{y}}E_{y}\]
\[D_{z}=\epsilon \frac{s_{y}}{s_{z}}E_{z}\]
such that now:
\[
  $
  \begin{bmatrix}
    \frac{\partial H_{z}}{\partial y}-\frac{\partial H_{y}}{\partial z} \\
    \frac{\partial H_{x}}{\partial z}-\frac{\partial H_{z}}{\partial x} \\
    \frac{\partial H_{y}}{\partial x}-\frac{\partial H_{x}}{\partial y}
  \end{bmatrix}
  =
  j\omega
  \begin{bmatrix}
    s_{y}  & 0      & 0     \\
    0      & s_{z}  & 0     \\
    0      & 0     & s_{x}  \\
  \end{bmatrix}
  \begin{bmatrix}
    E_{x} \\
    E_{y} \\
    E_{z}
  \end{bmatrix}
  $
\]
Using the defined values of s and that $\frac{\partial}{\partial t} = j \omega $:
\[
  $
  \begin{bmatrix}
    \frac{\partial H_{z}}{\partial y}-\frac{\partial H_{y}}{\partial z} \\
    \frac{\partial H_{x}}{\partial z}-\frac{\partial H_{z}}{\partial x} \\
    \frac{\partial H_{y}}{\partial x}-\frac{\partial H_{x}}{\partial y}
  \end{bmatrix}
  $
  =
  \frac{\partial}{\partial t}
  $
  \begin{bmatrix}
    \kappa_{y}  & 0           & 0           \\
    0           & \kappa_{z}  & 0           \\
    0           & 0           & \kappa_{x}  \\
  \end{bmatrix}
  \begin{bmatrix}
    D_{x} \\
    D_{y} \\
    D_{z}
  \end{bmatrix}
  $
  +\frac{1}{\epsilon_{0}}
  $
  \begin{bmatrix}
    \sigma_{y}  & 0           & 0           \\
    0           & \sigma_{z}  & 0           \\
    0           & 0           & \sigma_{x}  \\
  \end{bmatrix}
  \begin{bmatrix}
    D_{x} \\
    D_{y} \\
    D_{z}
  \end{bmatrix}
  $
\]

\\
\\
Discretize to find D\\
Update Components for D\\
Update Components for E\\
\\
Update Components for B\\
Update Components for H

\subsection{Graded Conductivity}

Reflection Factor
\[R(\theta)=\exp^{-2\eta cos(\theta)\int_{0}^{d}\sigma_{x}(x)dx\]

  Where $\sigma_{x}$ is the graded conductivity of the PML material.\\
  $\theta$ is the angle of incidence of the wave. So steeper angles of $\theta$
  will result in higher values of reflection error.\\
We want to minimize relfection R but also make sure the wave decays completely
in the PML boundary layer.

We are going to compare the error for different types of grading profiles.
And/or we can use different values in the grading profile 

\subsubsection{Polynomial grading}
Where the graded conductivity is:
\[\sigma_{x} = (\frac{x}{d})^{m} \sigma_{x,max}\]
And the graded value for $\kappa_{x}$ is:
\[\kappa_{x}=1+(\kappa_{x,max}-1)(\frac{x}{d})^{m}\]
Reflection factor simplifies to 

\subsubsection{Geometric grading}
Where the graded conductivity is:
\[\sigma_{x} =(g^{\frac{1}{\Delta}})^{x} \sigma_{x,0}\]

$\sigma_{x,0}$ is the conductivity at the surface of the PML.\\
g is a scaling factor. Nearly optimal: $2 \leq g \leq 3$\\
$\Delta$ is spacing of FDTD lattice.\\

And the graded value for $\kappa_{x}$ is:
\[\kappa_{x}=[(\kappa_{max})^{\frac{1}{d}}g^{\frac{1}{\Delta}}]^{x}\]

\section{Code}


\section{Error Analysis}
Insert Error Analysis Here

PMLs are exact for continuous functions, but error is introduced for discrete
functions. Having a large step discontinuity can

\subsubsection{Error of Polynomial Grading}

\subsubsection{Error of Geometric Grading}

\section{Fix me: Bibliography}
Susan's book - third edition

\end{document}